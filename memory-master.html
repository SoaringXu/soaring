<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°å­—ç¼–ç è®°å¿†è®­ç»ƒç³»ç»Ÿ</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --win-color: #ffbb00;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #333;
            --accent-color: #ff6b6b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        header {
            background-color: var(--primary-color);
            color: white;
            width: 100%;
            padding: 1rem 0;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 { margin: 0; font-size: 1.4rem; margin-bottom: 10px; }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            padding: 0 10px;
        }

        button {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background-color: rgba(255,255,255,0.2);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        button:hover {
            background-color: rgba(0, 115, 255, 0.4);
            transform: translateY(-1px);
        }

        button.active {
            background-color: white;
            color: var(--primary-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* ä¸»å†…å®¹å®¹å™¨ */
        #app-container {
            width: 95%;
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0 50px 0;
            flex: 1;
        }

        /* --- é¦–é¡µï¼šç½‘æ ¼å±•ç¤ºæ¨¡å¼ --- */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 12px;
            width: 100%;
        }

        .gallery-card {
            background: white;
            border-radius: 8px;
            padding: 10px 5px;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid transparent;
        }

        .gallery-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
            border-color: var(--primary-color);
        }

        .gallery-num {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--primary-color);
            display: block;
        }

        .gallery-img {
            height: 110px;
        }

        .gallery-name {
            font-size: 0.9rem;
            color: #555;
            margin-top: 4px;
        }

        /* --- å­¦ä¹ æ¨¡å¼ï¼šå¤§å¡ç‰‡ --- */
        .learning-card {
            width: 300px;
            height: 420px;
            perspective: 1000px;
            margin-top: 20px;
            cursor: pointer;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-radius: 20px;
        }

        .learning-card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 20px;
            padding: 20px;
            box-sizing: border-box;
        }

        .card-front {
            background-color: var(--primary-color);
            border: 1px solid #eee;
        }

        .card-back {
            background: white;
            color: white;
            transform: rotateY(180deg);
        }

        .card-main-num {
            font-size: 6rem;
            font-weight: bold;
            color: white;
            line-height: 1;
        }
        
        .card-back .card-main-num {
            color: rgba(255,255,255,0.2);
            font-size: 4rem;
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .card-main-name {
            color: var(--primary-color);
            font-size: 2.8rem;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .card-hint {
            color: #ccc;
            font-size: 0.9rem;
            margin-top: 20px;
        }

        .img-box {
            width: 180px;
            height: 180px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed rgba(255,255,255,0.3);
            margin-bottom: 10px;
        }

        /* åº•éƒ¨å¯¼èˆªæŒ‰é’® */
        .nav-bar {
            margin-top: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .nav-btn {
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            padding: 0;
        }

        /* --- æ¸¸æˆæ¨¡å¼ --- */
        .game-header {
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: #666;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            width: 100%;
            max-width: 600px;
        }

        .game-card {
            aspect-ratio: 3/4;
            background-color: white;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            font-weight: bold;
            font-size: 1.2rem;
            position: relative;
            transition: transform 0.3s;
        }

        .game-card.covered {
            background-color: var(--primary-color);
            color: transparent;
        }
        
        .game-card.covered::after {
            position: absolute;
            content: "?";
            color: rgba(255,255,255,0.5);
            font-size: 2rem;
        }

        .game-card.matched {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }

        .game-reset-btn {
            margin-top: 30px;
            background-color: var(--accent-color);
            color: white;
            padding: 10px 30px;
            border-radius: 25px;
            font-size: 1rem;
        }
        
        .game-reset-btn:hover {
            background-color: #ff5252;
        }

        .hide {
            display: none;
        }

        .game-win {
            color: var(--win-color);
            font-size: 36px;
            text-align: center;
        }

        @media (max-width: 600px) {
            button {
                padding: 4px 8px;
                font-weight: 400;
                transition: all 0.2s;
                font-size: 0.8rem;
            }
            .nav-bar { margin-top: 15px; }
            .gallery-grid { grid-template-columns: repeat(4, 1fr); }
            .game-grid { grid-template-columns: repeat(4, 1fr); gap: 5px; }
            .learning-card { width: 85vw; height: 110vw; max-height: 450px; margin-top:5px}
        }
    </style>
</head>
<body>

<header>
    <h1>æ•°å­—ç¼–ç è®°å¿†åŠ©æ‰‹</h1>
    <div class="controls">
        <button onclick="setMode('gallery')" id="btn-gallery" class="active">å…¨è§ˆé¦–é¡µ</button>
        <button onclick="setMode('sequential')" id="btn-seq">é¡ºåºå­¦ä¹ </button>
        <button onclick="setMode('random')" id="btn-rand">éšæœºæŠ½æŸ¥</button>
        <button onclick="setMode('game')" id="btn-game">é…å¯¹æŒ‘æˆ˜</button>
    </div>
</header>

<div id="app-container">
    </div>

<script>
    // --- å®Œæ•´æ•°æ® ---
    const memoryData = [
        { id: "0", name: "å‘¼å•¦åœˆ" }, { id: "1", name: "èœ¡çƒ›" }, { id: "2", name: "é¹…" }, { id: "3", name: "è€³æœµ" }, { id: "4", name: "å¸†èˆ¹" },
        { id: "5", name: "é’©å­" }, { id: "6", name: "å‹ºå­" }, { id: "7", name: "é•°åˆ€" }, { id: "8", name: "çœ¼é•œ" }, { id: "9", name: "å“¨å­" },
        { id: "00", name: "æœ›è¿œé•œ" }, { id: "01", name: "å°æ ‘" }, { id: "02", name: "é“ƒå„¿" }, { id: "03", name: "å‡³å­" }, { id: "04", name: "è½¿è½¦" },
        { id: "05", name: "æ‰‹å¥—" }, { id: "06", name: "æ‰‹æª" }, { id: "07", name: "é”„å¤´" }, { id: "08", name: "æºœå†°é‹" }, { id: "09", name: "çŒ«" },
        { id: "10", name: "æ£’çƒ" }, { id: "11", name: "æ¥¼æ¢¯" }, { id: "12", name: "æ¤…å„¿" }, { id: "13", name: "åŒ»ç”Ÿ" }, { id: "14", name: "é’¥åŒ™" },
        { id: "15", name: "é¹¦é¹‰" }, { id: "16", name: "çŸ³æ¦´" }, { id: "17", name: "ä»ªå™¨" }, { id: "18", name: "ç³–è‘«èŠ¦" }, { id: "19", name: "è¡£é’©" },
        { id: "20", name: "é¦™çƒŸ" }, { id: "21", name: "é³„é±¼" }, { id: "22", name: "åŒèƒèƒ" }, { id: "23", name: "å’Œå°š" }, { id: "24", name: "é—¹é’Ÿ" },
        { id: "25", name: "äºŒèƒ¡" }, { id: "26", name: "æ²³æµ" }, { id: "27", name: "è€³æœº" }, { id: "28", name: "æ¶éœ¸" }, { id: "29", name: "é¥¿å›š" },
        { id: "30", name: "ä¸‰è½®è½¦" }, { id: "31", name: "é²¨é±¼" }, { id: "32", name: "æ‰‡å„¿" }, { id: "33", name: "æ˜Ÿæ˜Ÿ" }, { id: "34", name: "ä¸‰ä¸" },
        { id: "35", name: "å±±è™" }, { id: "36", name: "å±±é¹¿" }, { id: "37", name: "å±±é¸¡" }, { id: "38", name: "å¦‡å¥³" }, { id: "39", name: "å±±ä¸˜" },
        { id: "40", name: "å¸ä»¤" }, { id: "41", name: "èœ¥èœ´" }, { id: "42", name: "æŸ¿å„¿" }, { id: "43", name: "çŸ³å±±" }, { id: "44", name: "è›‡" },
        { id: "45", name: "å¸ˆçˆ¶" }, { id: "46", name: "é¥²æ–™" }, { id: "47", name: "å¸æœº" }, { id: "48", name: "çŸ³æ¿" }, { id: "49", name: "æ¹¿ç‹—" },
        { id: "50", name: "æ­¦æ—" }, { id: "51", name: "å·¥äºº" }, { id: "52", name: "é¼“å„¿" }, { id: "53", name: "ä¹Œçº±å¸½" }, { id: "54", name: "é’å¹´" },
        { id: "55", name: "ç«è½¦" }, { id: "56", name: "èœ—ç‰›" }, { id: "57", name: "æ­¦å™¨" }, { id: "58", name: "å°¾å·´" }, { id: "59", name: "èœˆèš£" },
        { id: "60", name: "æ¦´è²" }, { id: "61", name: "å„¿ç«¥" }, { id: "62", name: "ç‰›å„¿" }, { id: "63", name: "æµæ²™" }, { id: "64", name: "èºä¸" },
        { id: "65", name: "ç»¿å£¶" }, { id: "66", name: "æºœæºœçƒ" }, { id: "67", name: "ç»¿æ¼†" }, { id: "68", name: "å–‡å­" }, { id: "69", name: "å¤ªæ" },
        { id: "70", name: "éº’éºŸ" }, { id: "71", name: "é¸¡ç¿¼" }, { id: "72", name: "ä¼é¹…" }, { id: "73", name: "èŠ±æ——å‚" }, { id: "74", name: "éª‘å£«" },
        { id: "75", name: "è¥¿æœ" }, { id: "76", name: "æ±½æ²¹" }, { id: "77", name: "æœºå™¨" }, { id: "78", name: "é’è›™" }, { id: "79", name: "æ°”çƒ" },
        { id: "80", name: "å·´é»" }, { id: "81", name: "ç™½èš" }, { id: "82", name: "é¶å„¿" }, { id: "83", name: "èŠ­è•‰æ‰‡" }, { id: "84", name: "å·´å£«" },
        { id: "85", name: "ä¿å§†" }, { id: "86", name: "å…«è·¯" }, { id: "87", name: "ç™½æ——" }, { id: "88", name: "çˆ¸çˆ¸" }, { id: "89", name: "èŠ­è•‰" },
        { id: "90", name: "é…’ç“¶" }, { id: "91", name: "çƒè¡£" }, { id: "92", name: "çƒå„¿" }, { id: "93", name: "æ—§ä¼" }, { id: "94", name: "é¦–é¥°" },
        { id: "95", name: "é…’å£¶" }, { id: "96", name: "è´è¶" }, { id: "97", name: "æ—§æ——" }, { id: "98", name: "é…’æ¯" }, { id: "99", name: "èˆ…èˆ…" }
    ];

    // --- çŠ¶æ€ ---
    let currentIndex = 0;
    let currentMode = 'gallery';
    const container = document.getElementById('app-container');

    // --- åˆå§‹åŒ– ---
    window.onload = () => {
        setMode('gallery');
    };

    // --- é”®ç›˜äº‹ä»¶ç›‘å¬ ---
    document.addEventListener('keydown', (e) => {
        // åªæœ‰åœ¨å­¦ä¹ æ¨¡å¼ä¸‹æ‰å“åº”
        if (currentMode === 'sequential') {
            if (e.key === 'ArrowLeft') {
                changeIndex(-1);
            } else if (e.key === 'ArrowRight') {
                changeIndex(1);
            } else if (e.key === ' ' || e.key === 'Enter') {
                // ç©ºæ ¼æˆ–å›è½¦ç¿»è½¬å¡ç‰‡
                e.preventDefault(); // é˜²æ­¢é¡µé¢æ»šåŠ¨
                const card = document.querySelector('.learning-card');
                if (card) card.classList.toggle('flipped');
            }
        } 
        else if (currentMode === 'random') {
            // éšæœºæ¨¡å¼ä¸‹ï¼Œå·¦é”®æˆ–å³é”®åˆ‡æ¢ä¸‹ä¸€å¼ 
            if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
                e.preventDefault();
                nextRandom();
            } else if (e.key === ' ' || e.key === 'Enter') {
                e.preventDefault();
                const card = document.querySelector('.learning-card');
                if (card) card.classList.toggle('flipped');
            }
        }
    });

    // --- æ¨¡å¼åˆ‡æ¢æ§åˆ¶å™¨ ---
    function setMode(mode, startIndex = 0) {
        currentMode = mode;
        if (mode === 'sequential') currentIndex = startIndex; // å…è®¸è·³è½¬åˆ°æŒ‡å®šç´¢å¼•

        // æ›´æ–°æŒ‰é’® UI
        document.querySelectorAll('.controls button').forEach(btn => btn.classList.remove('active'));
        const btnId = mode === 'sequential' ? 'btn-seq' : (mode === 'gallery' ? 'btn-gallery' : (mode === 'random' ? 'btn-rand' : 'btn-game'));
        document.getElementById(btnId).classList.add('active');

        // æ¸²æŸ“é¡µé¢
        container.innerHTML = ''; // æ¸…ç©º
        if (mode === 'gallery') renderGallery();
        else if (mode === 'sequential') renderCard(true);
        else if (mode === 'random') nextRandom();
        else if (mode === 'game') initGame();
    }

    // --- æ¨¡å¼ 0: é¦–é¡µå…¨è§ˆ (Gallery) ---
    function renderGallery() {
        let html = `<div class="gallery-grid">`;
        memoryData.forEach((item, index) => {
            const num = parseIndex(item);
            const imgContent = `<img src="res/memory/split_${num}.jpg" width="100%" class="gallery-img">`;
            html += `
                <div class="gallery-card" onclick="setMode('sequential', ${index})">
                    <span>${imgContent}</span>
                </div>
            `;
        });
        html += `</div>`;
        container.innerHTML = html;
    }
    function parseIndex(item) {
        let num = 0;
        if (item.id.length > 1) {
            num = padZero(parseInt(item.id) + 10, 3);
        } else {
            num = padZero(parseInt(item.id), 3);
        }
        return num;
    }
    function padZero(num, targetLength) {
        // åŒä¸Šé¢çš„å‚æ•°æ ¡éªŒé€»è¾‘
        if (typeof num !== 'number' || isNaN(num)) {
            throw new Error('ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯æœ‰æ•ˆçš„æ•°å­—');
        }
        if (typeof targetLength !== 'number' || targetLength < 0 || !Number.isInteger(targetLength)) {
            throw new Error('ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯éè´Ÿæ•´æ•°');
        }
        const numStr = num.toString();
        // è®¡ç®—éœ€è¦è¡¥çš„0çš„ä¸ªæ•°
        const padCount = targetLength - numStr.length;
        // è‹¥éœ€è¦è¡¥0ï¼Œåˆ™æ‹¼æ¥å¯¹åº”æ•°é‡çš„0 + åŸå­—ç¬¦ä¸²ï¼›å¦åˆ™ç›´æ¥è¿”å›åŸå­—ç¬¦ä¸²
        return padCount > 0 ? '0'.repeat(padCount) + numStr : numStr;
    }
    // --- æ¨¡å¼ 1 & 2: å­¦ä¹ å¡ç‰‡ (Sequential & Random) ---
    function renderCard(isSequential) {
        const item = isSequential ? memoryData[currentIndex] : currentRandomItem;
        
        // å¦‚æœä½ æœ‰å›¾ç‰‡ï¼Œè¯·æŠŠä¸‹é¢çš„imgContent æ”¹ä¸º <img src="<res-path>/${item.id}.jpg" style="max-width:100%; max-height:100%">
        // st imgContent = `<span style="font-size:3rem; color:rgba(255,255,255,0.5)">ğŸ–¼ï¸</span>`;
        const num = parseIndex(item);
        const imgContent = `<img src="res/memory/split_${num}.jpg" width="100%">`;

        let html = `
            <div class="learning-card" onclick="this.classList.toggle('flipped')">
                <div class="card-inner">
                    <div class="card-front">
                        <div class="card-main-num">${item.id}</div>
                        <div class="card-hint">ğŸ‘† ç‚¹å‡»æˆ–ç©ºæ ¼ç¿»é¢</div>
                    </div>
                    <div class="card-back">
                        <div class="img-box">${imgContent}</div>
                    </div>
                </div>
            </div>
            
            <div class="nav-bar">
                ${isSequential ? `
                    <button class="nav-btn" onclick="changeIndex(-1)" title="å·¦æ–¹å‘é”®">â€¹</button>
                    <span style="font-weight:bold; color:#666; min-width:80px; text-align:center;">
                        ${memoryData.indexOf(item) + 1} / ${memoryData.length}
                    </span>
                    <button class="nav-btn" onclick="changeIndex(1)" title="å³æ–¹å‘é”®">â€º</button>
                ` : `
                    <button class="nav-btn" style="width:auto; padding:0 20px; border-radius:20px" onclick="nextRandom()">
                        æ¢ä¸€å¼  â†»
                    </button>
                `}
            </div>
            <div class="keyboard-hint">âŒ¨ï¸ æç¤ºï¼šä½¿ç”¨ â¬…ï¸ â¡ï¸ é”®åˆ‡æ¢ï¼Œç©ºæ ¼é”®ç¿»é¢</div>
        `;
        container.innerHTML = html;
    }

    // é¡ºåºåˆ‡æ¢é€»è¾‘
    function changeIndex(direction) {
        const newIndex = currentIndex + direction;
        if (newIndex >= 0 && newIndex < memoryData.length) {
            currentIndex = newIndex;
            // ç¿»é¡µæ—¶ç¨å¾®é‡ç½®ä¸€ä¸‹å¡ç‰‡çŠ¶æ€ï¼ˆå¯é€‰ä¼˜åŒ–ï¼Œè¿™é‡Œç›´æ¥é‡ç»˜æœ€ç®€å•ï¼‰
            renderCard(true); 
        }
    }

    // éšæœºåˆ‡æ¢é€»è¾‘
    let currentRandomItem = null;
    function nextRandom() {
        currentRandomItem = memoryData[Math.floor(Math.random() * memoryData.length)];
        renderCard(false);
    }

    // --- æ¨¡å¼ 3: é…å¯¹æ¸¸æˆ (Game) ---
    let firstCard = null, secondCard = null, lockBoard = false;

    function initGame() {
        const gameCount = 8;  // Nå¯¹
        const shuffledAll = [...memoryData].sort(() => 0.5 - Math.random());
        const selected = shuffledAll.slice(0, gameCount);
        
        let gameItems = [];
        selected.forEach(item => {
            gameItems.push({ type: 'num', val: item.id, matchId: item.id });
            gameItems.push({ type: 'name', val: item.name, matchId: item.id });
        });
        gameItems.sort(() => 0.5 - Math.random());

        let html = `
            <div class="game-header">æ‰¾å‡º ${gameCount} ç»„å¯¹åº”çš„æ•°å­—å’Œåç§°</div>
            <div id="game-board" class="game-grid">
        `;
        
        gameItems.forEach(item => {
            let num = 0;
            let imgContent = "";
            if (item.type === 'name') {
                item.id = item.matchId;
                num = parseIndex(item);
                imgContent = `<img src="res/memory/split_${num}.jpg" width="100px" style="display:none"`;
            } else {
                imgContent = item.val;
            }
            const displayVal = item.type === 'num' ? item.val : imgContent;
            html += `
                <div class="game-card covered" data-match="${item.matchId}" onclick="flipGameCard(this)">
                    <span style="font-size:1.8rem">${displayVal}</span>
                </div>
            `;
        });

        html += `</div>
            <button id="restart" class="game-reset-btn hide" onclick="initGame()">é‡æ–°å¼€å§‹</button>
        `;
        container.innerHTML = html;
        resetBoard();
    }

    function showImage(card, display) {
        let imgDom = card.querySelector('img');
        if (imgDom) {
            imgDom.style.display = display;
        }
    }

    function flipGameCard(card) {
        if (lockBoard) return;
        if (card === firstCard) return;
        if (card.classList.contains('matched')) return;

        showImage(card, 'block');
        card.classList.remove('covered');

        if (!firstCard) {
            firstCard = card;
            return;
        }

        secondCard = card;
        checkForMatch();
    }

    function checkForMatch() {
        let isMatch = firstCard.dataset.match === secondCard.dataset.match;
        isMatch ? disableCards() : unflipCards();
    }

    function disableCards() {
        lockBoard = true;
        setTimeout(() => {
            firstCard.classList.add('matched');
            secondCard.classList.add('matched');
            resetBoard();
            checkWin();
        }, 400);
    }

    function unflipCards() {
        lockBoard = true;
        setTimeout(() => {
            firstCard.classList.add('covered');
            showImage(firstCard, 'none');
            secondCard.classList.add('covered');
            showImage(secondCard, 'none');
            resetBoard();
        }, 1000);
    }

    function resetBoard() {
        [firstCard, secondCard] = [null, null];
        lockBoard = false;
    }
    
    function checkWin() {
        const remaining = document.querySelectorAll('.game-card:not(.matched)');
        if (remaining.length === 0) {
            const gameBoard = document.getElementById('game-board');
            gameBoard.classList.remove('game-grid')
            gameBoard.classList.add('game-win')
            gameBoard.innerHTML = `<div class="game-win-msg">ğŸ‰æ­å–œï¼å…¨éƒ¨é…å¯¹æˆåŠŸï¼</div>`
            document.getElementById('restart').classList.remove('hide');
        }
    }
</script>

</body>
</html>
